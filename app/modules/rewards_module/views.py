'''
Rewards endpoint:
This will be a put request, where the body is a json file
1. Once dummy data is generated, it will call the rewards
endpoint to send to SAGEMAKER
2. This endpoint will also call the function to generate
    the csv file from json data.
3. GET endpoint exposed to the get recommendation list button
    (Called from frontend)
    Takes data from SAGEMAKER
'''
from decimal import Decimal
import csv
import boto3


def generate_csv(data):
    f = csv.writer(open('rewards.csv', 'w', newline=''))
    f.writerow(['price_value', 'type_of_product', 'preferred_merchant', 'reward_id', 'tier_status', 'target_merchant'])
    for reward in data:
        f.writerow(
            [
                reward['price_value'],
                reward['type_of_product'],
                reward['preferred_merchant'],
                reward['reward_id'],
                reward['tier_status'],
                reward['target_merchant']
            ]
        )

def send_to_s3():
    s3 = boto3.client('s3')
    s3.upload_file('./rewards.csv', 'sagemaker-studio-912ae080', 'rewards.csv')

generate_csv(
    [{'price_value': 181, 'type_of_product': 'sports', 'preferred_merchant': Decimal('0'), 'reward_id': None, 'tier_status': Decimal('1'), 'target_merchant': '3, 2, 1'}, {'price_value': 485, 'type_of_product': 'food', 'preferred_merchant': Decimal('0'), 'reward_id': None, 'tier_status': Decimal('1'), 'target_merchant': '3, 2, 1'}, {'price_value': 393, 'type_of_product': 'food', 'preferred_merchant': Decimal('0'), 'reward_id': None, 'tier_status': Decimal('1'), 'target_merchant': '3, 1, 2'}, {'price_value': 103, 'type_of_product': 'home', 'preferred_merchant': Decimal('0'), 'reward_id': None, 'tier_status': Decimal('1'), 'target_merchant': '3, 1, 2'}, {'price_value': 126, 'type_of_product': 'sports', 'preferred_merchant': Decimal('0'), 'reward_id': None, 'tier_status': Decimal('1'), 'target_merchant': '1, 2, 3'}, {'price_value': 225, 'type_of_product': 'food', 'preferred_merchant': Decimal('0'), 'reward_id': None, 'tier_status': Decimal('1'), 'target_merchant': '2, 3, 1'}, {'price_value': 343, 'type_of_product': 'apparel', 'preferred_merchant': Decimal('0'), 'reward_id': None, 'tier_status': Decimal('1'), 'target_merchant': '1, 3, 2'}, {'price_value': 60, 'type_of_product': 'home', 'preferred_merchant': Decimal('0'), 'reward_id': None, 'tier_status': Decimal('1'), 'target_merchant': '2, 1, 3'}, {'price_value': 381, 'type_of_product': 'home', 'preferred_merchant': Decimal('0'), 'reward_id': None, 'tier_status': Decimal('1'), 'target_merchant': '3, 1, 2'}, {'price_value': 112, 'type_of_product': 'apparel', 'preferred_merchant': Decimal('0'), 'reward_id': None, 'tier_status': Decimal('1'), 'target_merchant': '2, 1, 3'}, {'price_value': 256, 'type_of_product': 'apparel', 'preferred_merchant': Decimal('0'), 'reward_id': None, 'tier_status': Decimal('1'), 'target_merchant': '1, 2, 3'}, {'price_value': 306, 'type_of_product': 'sports', 'preferred_merchant': Decimal('0'), 'reward_id': None, 'tier_status': Decimal('1'), 'target_merchant': '2, 3, 1'}, {'price_value': 51, 'type_of_product': 'books', 'preferred_merchant': Decimal('0'), 'reward_id': None, 'tier_status': Decimal('1'), 'target_merchant': '2, 3, 1'}, {'price_value': 441, 'type_of_product': 'electronics', 'preferred_merchant': Decimal('0'), 'reward_id': None, 'tier_status': Decimal('1'), 'target_merchant': '2, 1, 3'}, {'price_value': 274, 'type_of_product': 'home', 'preferred_merchant': Decimal('0'), 'reward_id': None, 'tier_status': Decimal('1'), 'target_merchant': '3, 2, 1'}, {'price_value': 294, 'type_of_product': 'electronics', 'preferred_merchant': Decimal('0'), 'reward_id': None, 'tier_status': Decimal('1'), 'target_merchant': '3, 1, 2'}, {'price_value': 354, 'type_of_product': 'electronics', 'preferred_merchant': Decimal('0'), 'reward_id': None, 'tier_status': Decimal('1'), 'target_merchant': '1, 3, 2'}, {'price_value': 155, 'type_of_product': 'home', 'preferred_merchant': Decimal('0'), 'reward_id': None, 'tier_status': Decimal('1'), 'target_merchant': '3, 1, 2'}, {'price_value': 312, 'type_of_product': 'books', 'preferred_merchant': Decimal('0'), 'reward_id': None, 'tier_status': Decimal('1'), 'target_merchant': '3, 1, 2'}, {'price_value': 271, 'type_of_product': 'sports', 'preferred_merchant': Decimal('0'), 'reward_id': None, 'tier_status': Decimal('1'), 'target_merchant': '2, 1, 3'}, {'price_value': 450, 'type_of_product': 'sports', 'preferred_merchant': Decimal('0'), 'reward_id': None, 'tier_status': Decimal('1'), 'target_merchant': '3, 1, 2'}, {'price_value': 75, 'type_of_product': 'apparel', 'preferred_merchant': Decimal('0'), 'reward_id': None, 'tier_status': Decimal('1'), 'target_merchant': '1, 3, 2'}, {'price_value': 136, 'type_of_product': 'books', 'preferred_merchant': Decimal('0'), 'reward_id': None, 'tier_status': Decimal('1'), 'target_merchant': '2, 1, 3'}, {'price_value': 301, 'type_of_product': 'books', 'preferred_merchant': Decimal('0'), 'reward_id': None, 'tier_status': Decimal('1'), 'target_merchant': '1, 2, 3'}, {'price_value': 337, 'type_of_product': 'apparel', 'preferred_merchant': Decimal('0'), 'reward_id': None, 'tier_status': Decimal('1'), 'target_merchant': '2, 3, 1'}, {'price_value': 38, 'type_of_product': 'apparel', 'preferred_merchant': Decimal('0'), 'reward_id': None, 'tier_status': Decimal('1'), 'target_merchant': '2, 1, 3'}, {'price_value': 212, 'type_of_product': 'electronics', 'preferred_merchant': Decimal('0'), 'reward_id': None, 'tier_status': Decimal('1'), 'target_merchant': '1, 3, 2'}, {'price_value': 68, 'type_of_product': 'electronics', 'preferred_merchant': Decimal('0'), 'reward_id': None, 'tier_status': Decimal('1'), 'target_merchant': '2, 3, 1'}, {'price_value': 267, 'type_of_product': 'home', 'preferred_merchant': Decimal('0'), 'reward_id': None, 'tier_status': Decimal('1'), 'target_merchant': '2, 3, 1'}, {'price_value': 401, 'type_of_product': 'books', 'preferred_merchant': Decimal('0'), 'reward_id': None, 'tier_status': Decimal('1'), 'target_merchant': '2, 3, 1'}, {'price_value': 102, 'type_of_product': 'apparel', 'preferred_merchant': Decimal('0'), 'reward_id': None, 'tier_status': Decimal('1'), 'target_merchant': '1, 3, 2'}, {'price_value': 354, 'type_of_product': 'apparel', 'preferred_merchant': Decimal('0'), 'reward_id': None, 'tier_status': Decimal('1'), 'target_merchant': '1, 3, 2'}, {'price_value': 146, 'type_of_product': 'books', 'preferred_merchant': Decimal('0'), 'reward_id': None, 'tier_status': Decimal('1'), 'target_merchant': '1, 3, 2'}, {'price_value': 367, 'type_of_product': 'food', 'preferred_merchant': Decimal('0'), 'reward_id': None, 'tier_status': Decimal('1'), 'target_merchant': '1, 2, 3'}, {'price_value': 57, 'type_of_product': 'food', 'preferred_merchant': Decimal('0'), 'reward_id': None, 'tier_status': Decimal('1'), 'target_merchant': '3, 1, 2'}, {'price_value': 204, 'type_of_product': 'food', 'preferred_merchant': Decimal('0'), 'reward_id': None, 'tier_status': Decimal('1'), 'target_merchant': '2, 3, 1'}, {'price_value': 225, 'type_of_product': 'apparel', 'preferred_merchant': Decimal('0'), 'reward_id': None, 'tier_status': Decimal('1'), 'target_merchant': '1, 2, 3'}, {'price_value': 500, 'type_of_product': 'electronics', 'preferred_merchant': Decimal('0'), 'reward_id': None, 'tier_status': Decimal('1'), 'target_merchant': '2, 3, 1'}, {'price_value': 130, 'type_of_product': 'electronics', 'preferred_merchant': Decimal('0'), 'reward_id': None, 'tier_status': Decimal('1'), 'target_merchant': '1, 2, 3'}, {'price_value': 19, 'type_of_product': 'apparel', 'preferred_merchant': Decimal('0'), 'reward_id': None, 'tier_status': Decimal('1'), 'target_merchant': '3, 1, 2'}, {'price_value': 309, 'type_of_product': 'food', 'preferred_merchant': Decimal('0'), 'reward_id': None, 'tier_status': Decimal('1'), 'target_merchant': '3, 1, 2'}, {'price_value': 460, 'type_of_product': 'sports', 'preferred_merchant': Decimal('0'), 'reward_id': None, 'tier_status': Decimal('1'), 'target_merchant': '2, 3, 1'}, {'price_value': 156, 'type_of_product': 'apparel', 'preferred_merchant': Decimal('0'), 'reward_id': None, 'tier_status': Decimal('1'), 'target_merchant': '2, 1, 3'}, {'price_value': 444, 'type_of_product': 'apparel', 'preferred_merchant': Decimal('0'), 'reward_id': None, 'tier_status': Decimal('1'), 'target_merchant': '2, 1, 3'}, {'price_value': 145, 'type_of_product': 'apparel', 'preferred_merchant': Decimal('0'), 'reward_id': None, 'tier_status': Decimal('1'), 'target_merchant': '2, 1, 3'}, {'price_value': 392, 'type_of_product': 'books', 'preferred_merchant': Decimal('0'), 'reward_id': None, 'tier_status': Decimal('1'), 'target_merchant': '1, 2, 3'}, {'price_value': 247, 'type_of_product': 'sports', 'preferred_merchant': Decimal('0'), 'reward_id': None, 'tier_status': Decimal('1'), 'target_merchant': '2, 1, 3'}, {'price_value': 493, 'type_of_product': 'books', 'preferred_merchant': Decimal('0'), 'reward_id': None, 'tier_status': Decimal('1'), 'target_merchant': '3, 2, 1'}, {'price_value': 353, 'type_of_product': 'apparel', 'preferred_merchant': Decimal('0'), 'reward_id': None, 'tier_status': Decimal('1'), 'target_merchant': '3, 1, 2'}, {'price_value': 91, 'type_of_product': 'food', 'preferred_merchant': Decimal('0'), 'reward_id': None, 'tier_status': Decimal('1'), 'target_merchant': '3, 2, 1'}, {'price_value': 20, 'type_of_product': 'home', 'preferred_merchant': Decimal('0'), 'reward_id': None, 'tier_status': Decimal('1'), 'target_merchant': '1, 2, 3'}, {'price_value': 419, 'type_of_product': 'electronics', 'preferred_merchant': Decimal('0'), 'reward_id': None, 'tier_status': Decimal('1'), 'target_merchant': '2, 1, 3'}, {'price_value': 29, 'type_of_product': 'electronics', 'preferred_merchant': Decimal('0'), 'reward_id': None, 'tier_status': Decimal('1'), 'target_merchant': '1, 2, 3'}, {'price_value': 162, 'type_of_product': 'books', 'preferred_merchant': Decimal('0'), 'reward_id': None, 'tier_status': Decimal('1'), 'target_merchant': '2, 1, 3'}, {'price_value': 68, 'type_of_product': 'sports', 'preferred_merchant': Decimal('0'), 'reward_id': None, 'tier_status': Decimal('1'), 'target_merchant': '1, 2, 3'}, {'price_value': 341, 'type_of_product': 'electronics', 'preferred_merchant': Decimal('0'), 'reward_id': None, 'tier_status': Decimal('1'), 'target_merchant': '3, 1, 2'}, {'price_value': 87, 'type_of_product': 'food', 'preferred_merchant': Decimal('0'), 'reward_id': None, 'tier_status': Decimal('1'), 'target_merchant': '1, 2, 3'}, {'price_value': 361, 'type_of_product': 'home', 'preferred_merchant': Decimal('0'), 'reward_id': None, 'tier_status': Decimal('1'), 'target_merchant': '3, 1, 2'}, {'price_value': 252, 'type_of_product': 'sports', 'preferred_merchant': Decimal('0'), 'reward_id': None, 'tier_status': Decimal('1'), 'target_merchant': '3, 1, 2'}, {'price_value': 45, 'type_of_product': 'apparel', 'preferred_merchant': Decimal('0'), 'reward_id': None, 'tier_status': Decimal('1'), 'target_merchant': '3, 2, 1'}, {'price_value': 19, 'type_of_product': 'apparel', 'preferred_merchant': Decimal('0'), 'reward_id': None, 'tier_status': Decimal('1'), 'target_merchant': '3, 1, 2'}, {'price_value': 377, 'type_of_product': 'sports', 'preferred_merchant': Decimal('0'), 'reward_id': None, 'tier_status': Decimal('1'), 'target_merchant': '1, 2, 3'}, {'price_value': 42, 'type_of_product': 'electronics', 'preferred_merchant': Decimal('0'), 'reward_id': None, 'tier_status': Decimal('1'), 'target_merchant': '1, 3, 2'}, {'price_value': 24, 'type_of_product': 'home', 'preferred_merchant': Decimal('0'), 'reward_id': None, 'tier_status': Decimal('1'), 'target_merchant': '2, 3, 1'}, {'price_value': 255, 'type_of_product': 'apparel', 'preferred_merchant': Decimal('0'), 'reward_id': None, 'tier_status': Decimal('1'), 'target_merchant': '1, 3, 2'}, {'price_value': 334, 'type_of_product': 'electronics', 'preferred_merchant': Decimal('0'), 'reward_id': None, 'tier_status': Decimal('1'), 'target_merchant': '2, 3, 1'}, {'price_value': 169, 'type_of_product': 'books', 'preferred_merchant': Decimal('0'), 'reward_id': None, 'tier_status': Decimal('1'), 'target_merchant': '1, 2, 3'}, {'price_value': 221, 'type_of_product': 'electronics', 'preferred_merchant': Decimal('0'), 'reward_id': None, 'tier_status': Decimal('1'), 'target_merchant': '2, 1, 3'}, {'price_value': 298, 'type_of_product': 'sports', 'preferred_merchant': Decimal('0'), 'reward_id': None, 'tier_status': Decimal('1'), 'target_merchant': '1, 2, 3'}, {'price_value': 443, 'type_of_product': 'food', 'preferred_merchant': Decimal('0'), 'reward_id': None, 'tier_status': Decimal('1'), 'target_merchant': '1, 2, 3'}, {'price_value': 319, 'type_of_product': 'sports', 'preferred_merchant': Decimal('0'), 'reward_id': None, 'tier_status': Decimal('1'), 'target_merchant': '2, 1, 3'}, {'price_value': 50, 'type_of_product': 'electronics', 'preferred_merchant': Decimal('0'), 'reward_id': None, 'tier_status': Decimal('1'), 'target_merchant': '3, 1, 2'}, {'price_value': 218, 'type_of_product': 'books', 'preferred_merchant': Decimal('0'), 'reward_id': None, 'tier_status': Decimal('1'), 'target_merchant': '2, 3, 1'}, {'price_value': 39, 'type_of_product': 'books', 'preferred_merchant': Decimal('0'), 'reward_id': None, 'tier_status': Decimal('1'), 'target_merchant': '3, 2, 1'}, {'price_value': 453, 'type_of_product': 'home', 'preferred_merchant': Decimal('0'), 'reward_id': None, 'tier_status': Decimal('1'), 'target_merchant': '3, 1, 2'}, {'price_value': 12, 'type_of_product': 'home', 'preferred_merchant': Decimal('0'), 'reward_id': None, 'tier_status': Decimal('1'), 'target_merchant': '1, 2, 3'}, {'price_value': 67, 'type_of_product': 'sports', 'preferred_merchant': Decimal('0'), 'reward_id': None, 'tier_status': Decimal('1'), 'target_merchant': '3, 1, 2'}, {'price_value': 393, 'type_of_product': 'apparel', 'preferred_merchant': Decimal('0'), 'reward_id': None, 'tier_status': Decimal('1'), 'target_merchant': '1, 3, 2'}, {'price_value': 196, 'type_of_product': 'books', 'preferred_merchant': Decimal('0'), 'reward_id': None, 'tier_status': Decimal('1'), 'target_merchant': '1, 2, 3'}, {'price_value': 197, 'type_of_product': 'apparel', 'preferred_merchant': Decimal('0'), 'reward_id': None, 'tier_status': Decimal('1'), 'target_merchant': '1, 2, 3'}, {'price_value': 399, 'type_of_product': 'sports', 'preferred_merchant': Decimal('0'), 'reward_id': None, 'tier_status': Decimal('1'), 'target_merchant': '1, 3, 2'}, {'price_value': 484, 'type_of_product': 'electronics', 'preferred_merchant': Decimal('0'), 'reward_id': None, 'tier_status': Decimal('1'), 'target_merchant': '2, 1, 3'}, {'price_value': 403, 'type_of_product': 'electronics', 'preferred_merchant': Decimal('0'), 'reward_id': None, 'tier_status': Decimal('1'), 'target_merchant': '1, 3, 2'}, {'price_value': 61, 'type_of_product': 'electronics', 'preferred_merchant': Decimal('0'), 'reward_id': None, 'tier_status': Decimal('1'), 'target_merchant': '2, 1, 3'}, {'price_value': 145, 'type_of_product': 'sports', 'preferred_merchant': Decimal('0'), 'reward_id': None, 'tier_status': Decimal('1'), 'target_merchant': '3, 1, 2'}, {'price_value': 305, 'type_of_product': 'apparel', 'preferred_merchant': Decimal('0'), 'reward_id': None, 'tier_status': Decimal('1'), 'target_merchant': '1, 2, 3'}, {'price_value': 159, 'type_of_product': 'home', 'preferred_merchant': Decimal('0'), 'reward_id': None, 'tier_status': Decimal('1'), 'target_merchant': '1, 2, 3'}, {'price_value': 124, 'type_of_product': 'books', 'preferred_merchant': Decimal('0'), 'reward_id': None, 'tier_status': Decimal('1'), 'target_merchant': '2, 1, 3'}, {'price_value': 232, 'type_of_product': 'books', 'preferred_merchant': Decimal('0'), 'reward_id': None, 'tier_status': Decimal('1'), 'target_merchant': '2, 1, 3'}, {'price_value': 80, 'type_of_product': 'sports', 'preferred_merchant': Decimal('0'), 'reward_id': None, 'tier_status': Decimal('1'), 'target_merchant': '2, 1, 3'}, {'price_value': 369, 'type_of_product': 'food', 'preferred_merchant': Decimal('0'), 'reward_id': None, 'tier_status': Decimal('1'), 'target_merchant': '2, 1, 3'}, {'price_value': 270, 'type_of_product': 'books', 'preferred_merchant': Decimal('0'), 'reward_id': None, 'tier_status': Decimal('1'), 'target_merchant': '1, 2, 3'}, {'price_value': 495, 'type_of_product': 'electronics', 'preferred_merchant': Decimal('0'), 'reward_id': None, 'tier_status': Decimal('1'), 'target_merchant': '2, 1, 3'}, {'price_value': 18, 'type_of_product': 'books', 'preferred_merchant': Decimal('0'), 'reward_id': None, 'tier_status': Decimal('1'), 'target_merchant': '3, 2, 1'}, {'price_value': 402, 'type_of_product': 'sports', 'preferred_merchant': Decimal('0'), 'reward_id': None, 'tier_status': Decimal('1'), 'target_merchant': '2, 1, 3'}, {'price_value': 371, 'type_of_product': 'home', 'preferred_merchant': Decimal('0'), 'reward_id': None, 'tier_status': Decimal('1'), 'target_merchant': '1, 2, 3'}, {'price_value': 371, 'type_of_product': 'food', 'preferred_merchant': Decimal('0'), 'reward_id': None, 'tier_status': Decimal('1'), 'target_merchant': '1, 3, 2'}, {'price_value': 58, 'type_of_product': 'food', 'preferred_merchant': Decimal('0'), 'reward_id': None, 'tier_status': Decimal('1'), 'target_merchant': '2, 1, 3'}, {'price_value': 400, 'type_of_product': 'sports', 'preferred_merchant': Decimal('0'), 'reward_id': None, 'tier_status': Decimal('1'), 'target_merchant': '1, 3, 2'}, {'price_value': 350, 'type_of_product': 'home', 'preferred_merchant': Decimal('0'), 'reward_id': None, 'tier_status': Decimal('1'), 'target_merchant': '3, 2, 1'}]
)
send_to_s3()