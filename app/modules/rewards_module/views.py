'''
Rewards endpoint:
This will be a put request, where the body is a json file
1. Once dummy data is generated, it will call the rewards 
endpoint to send to SAGEMAKER
2. This endpoint will also call the function to generate 
    the csv file from json data.
3. GET endpoint exposed to the get recommendation list button
    (Called from frontend)
    Takes data from SAGEMAKER
'''
from decimal import Decimal
import csv
import sagemaker
import boto3


def generate_csv(data):
    f = csv.writer(open('rewards.csv', 'w', newline=''))
    f.writerow(['price_value', 'type_of_product', 'preferred_merchant', 'reward_id', 'tier_status', 'target_merchant'])
    for reward in data:
        f.writerow(
            [
                reward['price_value'],
                reward['type_of_product'],
                reward['preferred_merchant'],
                reward['reward_id'],
                reward['tier_status'],
                reward['target_merchant']   
            ]
        )

data = [{'price_value': 115, 'type_of_product': 'food', 'preferred_merchant': Decimal('1'), 'reward_id': Decimal('1'), 'tier_status': Decimal('1'), 'target_merchant': '0, 2, 2'}, {'price_value': 156, 'type_of_product': 'apparel', 'preferred_merchant': Decimal('1'), 'reward_id': Decimal('1'), 'tier_status': Decimal('1'), 'target_merchant': '2, 2, 1'}, {'price_value': 88, 'type_of_product': 'books', 'preferred_merchant': Decimal('1'), 'reward_id': Decimal('1'), 'tier_status': Decimal('1'), 'target_merchant': '1, 2, 2'}, {'price_value': 70, 'type_of_product': 'home', 'preferred_merchant': Decimal('1'), 'reward_id': Decimal('1'), 'tier_status': Decimal('1'), 'target_merchant': '1, 1, 2'}, {'price_value': 401, 'type_of_product': 'books', 'preferred_merchant': Decimal('1'), 'reward_id': Decimal('1'), 'tier_status': Decimal('1'), 'target_merchant': '0, 2, 2'}, {'price_value': 62, 'type_of_product': 'sports', 'preferred_merchant': Decimal('1'), 'reward_id': Decimal('1'), 'tier_status': Decimal('1'), 'target_merchant': '1, 1, 0'}, {'price_value': 80, 'type_of_product': 'home', 'preferred_merchant': Decimal('1'), 'reward_id': Decimal('1'), 'tier_status': Decimal('1'), 'target_merchant': '1, 1, 0'}, {'price_value': 406, 'type_of_product': 'books', 'preferred_merchant': Decimal('1'), 'reward_id': Decimal('1'), 'tier_status': Decimal('1'), 'target_merchant': '2, 2, 2'}, {'price_value': 444, 'type_of_product': 'sports', 'preferred_merchant': Decimal('1'), 'reward_id': Decimal('1'), 'tier_status': Decimal('1'), 'target_merchant': '1, 0, 0'}, {'price_value': 234, 'type_of_product': 'sports', 'preferred_merchant': Decimal('1'), 'reward_id': Decimal('1'), 'tier_status': Decimal('1'), 'target_merchant': '1, 0, 0'}, {'price_value': 147, 'type_of_product': 'food', 'preferred_merchant': Decimal('1'), 'reward_id': Decimal('1'), 'tier_status': Decimal('1'), 'target_merchant': '1, 1, 2'}, {'price_value': 437, 'type_of_product': 'home', 'preferred_merchant': Decimal('1'), 'reward_id': Decimal('1'), 'tier_status': Decimal('1'), 'target_merchant': '0, 2, 1'}, {'price_value': 432, 'type_of_product': 'sports', 'preferred_merchant': Decimal('1'), 'reward_id': Decimal('1'), 'tier_status': Decimal('1'), 'target_merchant': '2, 2, 1'}, {'price_value': 246, 'type_of_product': 'books', 'preferred_merchant': Decimal('1'), 'reward_id': Decimal('1'), 'tier_status': Decimal('1'), 'target_merchant': '2, 0, 2'}, {'price_value': 108, 'type_of_product': 'food', 'preferred_merchant': Decimal('1'), 'reward_id': Decimal('1'), 'tier_status': Decimal('1'), 'target_merchant': '1, 0, 0'}, {'price_value': 300, 'type_of_product': 'books', 'preferred_merchant': Decimal('1'), 'reward_id': Decimal('1'), 'tier_status': Decimal('1'), 'target_merchant': '2, 1, 2'}, {'price_value': 176, 'type_of_product': 'electronics', 'preferred_merchant': Decimal('1'), 'reward_id': Decimal('1'), 'tier_status': Decimal('1'), 'target_merchant': '2, 2, 0'}, {'price_value': 100, 'type_of_product': 'electronics', 'preferred_merchant': Decimal('1'), 'reward_id': Decimal('1'), 'tier_status': Decimal('1'), 'target_merchant': '0, 2, 1'}, {'price_value': 438, 'type_of_product': 'books', 'preferred_merchant': Decimal('1'), 'reward_id': Decimal('1'), 'tier_status': Decimal('1'), 'target_merchant': '2, 1, 0'}, {'price_value': 145, 'type_of_product': 'apparel', 'preferred_merchant': Decimal('1'), 'reward_id': Decimal('1'), 'tier_status': Decimal('1'), 'target_merchant': '1, 1, 0'}, {'price_value': 48, 'type_of_product': 'sports', 'preferred_merchant': Decimal('1'), 'reward_id': Decimal('1'), 'tier_status': Decimal('1'), 'target_merchant': '0, 0, 0'}, {'price_value': 437, 'type_of_product': 'apparel', 'preferred_merchant': Decimal('1'), 'reward_id': Decimal('1'), 'tier_status': Decimal('1'), 'target_merchant': '2, 1, 2'}, {'price_value': 375, 'type_of_product': 'apparel', 'preferred_merchant': Decimal('1'), 'reward_id': Decimal('1'), 'tier_status': Decimal('1'), 'target_merchant': '0, 2, 2'}, {'price_value': 105, 'type_of_product': 'food', 'preferred_merchant': Decimal('1'), 'reward_id': Decimal('1'), 'tier_status': Decimal('1'), 'target_merchant': '2, 2, 1'}, {'price_value': 405, 'type_of_product': 'home', 'preferred_merchant': Decimal('1'), 'reward_id': Decimal('1'), 'tier_status': Decimal('1'), 'target_merchant': '1, 1, 2'}, {'price_value': 60, 'type_of_product': 'sports', 'preferred_merchant': Decimal('1'), 'reward_id': Decimal('1'), 'tier_status': Decimal('1'), 'target_merchant': '2, 0, 2'}, {'price_value': 199, 'type_of_product': 'sports', 'preferred_merchant': Decimal('1'), 'reward_id': Decimal('1'), 'tier_status': Decimal('1'), 'target_merchant': '0, 1, 0'}, {'price_value': 490, 'type_of_product': 'books', 'preferred_merchant': Decimal('1'), 'reward_id': Decimal('1'), 'tier_status': Decimal('1'), 'target_merchant': '1, 0, 0'}, {'price_value': 267, 'type_of_product': 'electronics', 'preferred_merchant': Decimal('1'), 'reward_id': Decimal('1'), 'tier_status': Decimal('1'), 'target_merchant': '1, 2, 0'}, {'price_value': 191, 'type_of_product': 'food', 'preferred_merchant': Decimal('1'), 'reward_id': Decimal('1'), 'tier_status': Decimal('1'), 'target_merchant': '0, 2, 2'}, {'price_value': 285, 'type_of_product': 'food', 'preferred_merchant': Decimal('1'), 'reward_id': Decimal('1'), 'tier_status': Decimal('1'), 'target_merchant': '2, 2, 2'}, {'price_value': 453, 'type_of_product': 'books', 'preferred_merchant': Decimal('1'), 'reward_id': Decimal('1'), 'tier_status': Decimal('1'), 'target_merchant': '1, 1, 2'}, {'price_value': 46, 'type_of_product': 'sports', 'preferred_merchant': Decimal('1'), 'reward_id': Decimal('1'), 'tier_status': Decimal('1'), 'target_merchant': '2, 0, 1'}, {'price_value': 24, 'type_of_product': 'food', 'preferred_merchant': Decimal('1'), 'reward_id': Decimal('1'), 'tier_status': Decimal('1'), 'target_merchant': '0, 2, 2'}, {'price_value': 163, 'type_of_product': 'food', 'preferred_merchant': Decimal('1'), 'reward_id': Decimal('1'), 'tier_status': Decimal('1'), 'target_merchant': '0, 2, 1'}, {'price_value': 58, 'type_of_product': 'electronics', 'preferred_merchant': Decimal('1'), 'reward_id': Decimal('1'), 'tier_status': Decimal('1'), 'target_merchant': '0, 2, 1'}, {'price_value': 164, 'type_of_product': 'sports', 'preferred_merchant': Decimal('1'), 'reward_id': Decimal('1'), 'tier_status': Decimal('1'), 'target_merchant': '1, 2, 1'}, {'price_value': 497, 'type_of_product': 'books', 'preferred_merchant': Decimal('1'), 'reward_id': Decimal('1'), 'tier_status': Decimal('1'), 'target_merchant': '1, 1, 2'}, {'price_value': 65, 'type_of_product': 'electronics', 'preferred_merchant': Decimal('1'), 'reward_id': Decimal('1'), 'tier_status': Decimal('1'), 'target_merchant': '1, 2, 2'}, {'price_value': 194, 'type_of_product': 'books', 'preferred_merchant': Decimal('1'), 'reward_id': Decimal('1'), 'tier_status': Decimal('1'), 'target_merchant': '0, 1, 2'}, {'price_value': 86, 'type_of_product': 'home', 'preferred_merchant': Decimal('1'), 'reward_id': Decimal('1'), 'tier_status': Decimal('1'), 'target_merchant': '1, 0, 1'}, {'price_value': 290, 'type_of_product': 'food', 'preferred_merchant': Decimal('1'), 'reward_id': Decimal('1'), 'tier_status': Decimal('1'), 'target_merchant': '1, 0, 1'}, {'price_value': 195, 'type_of_product': 'books', 'preferred_merchant': Decimal('1'), 'reward_id': Decimal('1'), 'tier_status': Decimal('1'), 'target_merchant': '1, 0, 2'}, {'price_value': 22, 'type_of_product': 'food', 'preferred_merchant': Decimal('1'), 'reward_id': Decimal('1'), 'tier_status': Decimal('1'), 'target_merchant': '2, 1, 0'}, {'price_value': 255, 'type_of_product': 'food', 'preferred_merchant': Decimal('1'), 'reward_id': Decimal('1'), 'tier_status': Decimal('1'), 'target_merchant': '0, 0, 0'}, {'price_value': 382, 'type_of_product': 'home', 'preferred_merchant': Decimal('1'), 'reward_id': Decimal('1'), 'tier_status': Decimal('1'), 'target_merchant': '2, 2, 0'}, {'price_value': 229, 'type_of_product': 'apparel', 'preferred_merchant': Decimal('1'), 'reward_id': Decimal('1'), 'tier_status': Decimal('1'), 'target_merchant': '1, 1, 0'}, {'price_value': 226, 'type_of_product': 'books', 'preferred_merchant': Decimal('1'), 'reward_id': Decimal('1'), 'tier_status': Decimal('1'), 'target_merchant': '0, 2, 1'}, {'price_value': 457, 'type_of_product': 'sports', 'preferred_merchant': Decimal('1'), 'reward_id': Decimal('1'), 'tier_status': Decimal('1'), 'target_merchant': '0, 2, 0'}, {'price_value': 301, 'type_of_product': 'sports', 'preferred_merchant': Decimal('1'), 'reward_id': Decimal('1'), 'tier_status': Decimal('1'), 'target_merchant': '0, 0, 0'}, {'price_value': 141, 'type_of_product': 'home', 'preferred_merchant': Decimal('1'), 'reward_id': Decimal('1'), 'tier_status': Decimal('1'), 'target_merchant': '2, 2, 0'}, {'price_value': 355, 'type_of_product': 'food', 'preferred_merchant': Decimal('1'), 'reward_id': Decimal('1'), 'tier_status': Decimal('1'), 'target_merchant': '2, 1, 0'}, {'price_value': 201, 'type_of_product': 'food', 'preferred_merchant': Decimal('1'), 'reward_id': Decimal('1'), 'tier_status': Decimal('1'), 'target_merchant': '1, 2, 2'}, {'price_value': 53, 'type_of_product': 'books', 'preferred_merchant': Decimal('1'), 'reward_id': Decimal('1'), 'tier_status': Decimal('1'), 'target_merchant': '2, 0, 0'}, {'price_value': 55, 'type_of_product': 'food', 'preferred_merchant': Decimal('1'), 'reward_id': Decimal('1'), 'tier_status': Decimal('1'), 'target_merchant': '1, 0, 2'}, {'price_value': 419, 'type_of_product': 'books', 'preferred_merchant': Decimal('1'), 'reward_id': Decimal('1'), 'tier_status': Decimal('1'), 'target_merchant': '0, 2, 0'}, {'price_value': 216, 'type_of_product': 'food', 'preferred_merchant': Decimal('1'), 'reward_id': Decimal('1'), 'tier_status': Decimal('1'), 'target_merchant': '1, 0, 1'}, {'price_value': 94, 'type_of_product': 'home', 'preferred_merchant': Decimal('1'), 'reward_id': Decimal('1'), 'tier_status': Decimal('1'), 'target_merchant': '1, 1, 2'}, {'price_value': 466, 'type_of_product': 'home', 'preferred_merchant': Decimal('1'), 'reward_id': Decimal('1'), 'tier_status': Decimal('1'), 'target_merchant': '0, 2, 0'}, {'price_value': 203, 'type_of_product': 'electronics', 'preferred_merchant': Decimal('1'), 'reward_id': Decimal('1'), 'tier_status': Decimal('1'), 'target_merchant': '1, 0, 0'}, {'price_value': 397, 'type_of_product': 'books', 'preferred_merchant': Decimal('1'), 'reward_id': Decimal('1'), 'tier_status': Decimal('1'), 'target_merchant': '0, 2, 0'}, {'price_value': 463, 'type_of_product': 'home', 'preferred_merchant': Decimal('1'), 'reward_id': Decimal('1'), 'tier_status': Decimal('1'), 'target_merchant': '1, 1, 0'}, {'price_value': 459, 'type_of_product': 'books', 'preferred_merchant': Decimal('1'), 'reward_id': Decimal('1'), 'tier_status': Decimal('1'), 'target_merchant': '2, 2, 1'}, {'price_value': 193, 'type_of_product': 'electronics', 'preferred_merchant': Decimal('1'), 'reward_id': Decimal('1'), 'tier_status': Decimal('1'), 'target_merchant': '2, 0, 0'}, {'price_value': 401, 'type_of_product': 'food', 'preferred_merchant': Decimal('1'), 'reward_id': Decimal('1'), 'tier_status': Decimal('1'), 'target_merchant': '0, 0, 1'}, {'price_value': 235, 'type_of_product': 'home', 'preferred_merchant': Decimal('1'), 'reward_id': Decimal('1'), 'tier_status': Decimal('1'), 'target_merchant': '2, 0, 1'}, {'price_value': 261, 'type_of_product': 'apparel', 'preferred_merchant': Decimal('1'), 'reward_id': Decimal('1'), 'tier_status': Decimal('1'), 'target_merchant': '0, 2, 0'}, {'price_value': 137, 'type_of_product': 'books', 'preferred_merchant': Decimal('1'), 'reward_id': Decimal('1'), 'tier_status': Decimal('1'), 'target_merchant': '2, 0, 2'}, {'price_value': 230, 'type_of_product': 'home', 'preferred_merchant': Decimal('1'), 'reward_id': Decimal('1'), 'tier_status': Decimal('1'), 'target_merchant': '1, 0, 1'}, {'price_value': 487, 'type_of_product': 'sports', 'preferred_merchant': Decimal('1'), 'reward_id': Decimal('1'), 'tier_status': Decimal('1'), 'target_merchant': '1, 1, 0'}, {'price_value': 155, 'type_of_product': 'books', 'preferred_merchant': Decimal('1'), 'reward_id': Decimal('1'), 'tier_status': Decimal('1'), 'target_merchant': '1, 2, 1'}, {'price_value': 402, 'type_of_product': 'food', 'preferred_merchant': Decimal('1'), 'reward_id': Decimal('1'), 'tier_status': Decimal('1'), 'target_merchant': '1, 0, 0'}, {'price_value': 126, 'type_of_product': 'food', 'preferred_merchant': Decimal('1'), 'reward_id': Decimal('1'), 'tier_status': Decimal('1'), 'target_merchant': '1, 2, 1'}, {'price_value': 76, 'type_of_product': 'apparel', 'preferred_merchant': Decimal('1'), 'reward_id': Decimal('1'), 'tier_status': Decimal('1'), 'target_merchant': '0, 1, 1'}, {'price_value': 315, 'type_of_product': 'home', 'preferred_merchant': Decimal('1'), 'reward_id': Decimal('1'), 'tier_status': Decimal('1'), 'target_merchant': '0, 1, 0'}, {'price_value': 406, 'type_of_product': 'sports', 'preferred_merchant': Decimal('1'), 'reward_id': Decimal('1'), 'tier_status': Decimal('1'), 'target_merchant': '1, 2, 0'}, {'price_value': 252, 'type_of_product': 'food', 'preferred_merchant': Decimal('1'), 'reward_id': Decimal('1'), 'tier_status': Decimal('1'), 'target_merchant': '1, 1, 2'}, {'price_value': 431, 'type_of_product': 'home', 'preferred_merchant': Decimal('1'), 'reward_id': Decimal('1'), 'tier_status': Decimal('1'), 'target_merchant': '2, 1, 1'}, {'price_value': 164, 'type_of_product': 'apparel', 'preferred_merchant': Decimal('1'), 'reward_id': Decimal('1'), 'tier_status': Decimal('1'), 'target_merchant': '1, 2, 1'}, {'price_value': 82, 'type_of_product': 'electronics', 'preferred_merchant': Decimal('1'), 'reward_id': Decimal('1'), 'tier_status': Decimal('1'), 'target_merchant': '2, 0, 0'}, {'price_value': 273, 'type_of_product': 'home', 'preferred_merchant': Decimal('1'), 'reward_id': Decimal('1'), 'tier_status': Decimal('1'), 'target_merchant': '2, 0, 2'}, {'price_value': 116, 'type_of_product': 'food', 'preferred_merchant': Decimal('1'), 'reward_id': Decimal('1'), 'tier_status': Decimal('1'), 'target_merchant': '1, 1, 0'}, {'price_value': 27, 'type_of_product': 'apparel', 'preferred_merchant': Decimal('1'), 'reward_id': Decimal('1'), 'tier_status': Decimal('1'), 'target_merchant': '2, 0, 2'}, {'price_value': 87, 'type_of_product': 'home', 'preferred_merchant': Decimal('1'), 'reward_id': Decimal('1'), 'tier_status': Decimal('1'), 'target_merchant': '1, 0, 1'}, {'price_value': 7, 'type_of_product': 'apparel', 'preferred_merchant': Decimal('1'), 'reward_id': Decimal('1'), 'tier_status': Decimal('1'), 'target_merchant': '2, 2, 0'}, {'price_value': 157, 'type_of_product': 'books', 'preferred_merchant': Decimal('1'), 'reward_id': Decimal('1'), 'tier_status': Decimal('1'), 'target_merchant': '0, 2, 0'}, {'price_value': 81, 'type_of_product': 'books', 'preferred_merchant': Decimal('1'), 'reward_id': Decimal('1'), 'tier_status': Decimal('1'), 'target_merchant': '0, 0, 1'}, {'price_value': 233, 'type_of_product': 'apparel', 'preferred_merchant': Decimal('1'), 'reward_id': Decimal('1'), 'tier_status': Decimal('1'), 'target_merchant': '1, 0, 2'}, {'price_value': 35, 'type_of_product': 'sports', 'preferred_merchant': Decimal('1'), 'reward_id': Decimal('1'), 'tier_status': Decimal('1'), 'target_merchant': '2, 2, 1'}, {'price_value': 74, 'type_of_product': 'books', 'preferred_merchant': Decimal('1'), 'reward_id': Decimal('1'), 'tier_status': Decimal('1'), 'target_merchant': '1, 1, 0'}, {'price_value': 380, 'type_of_product': 'books', 'preferred_merchant': Decimal('1'), 'reward_id': Decimal('1'), 'tier_status': Decimal('1'), 'target_merchant': '2, 1, 2'}, {'price_value': 493, 'type_of_product': 'food', 'preferred_merchant': Decimal('1'), 'reward_id': Decimal('1'), 'tier_status': Decimal('1'), 'target_merchant': '1, 2, 0'}, {'price_value': 90, 'type_of_product': 'home', 'preferred_merchant': Decimal('1'), 'reward_id': Decimal('1'), 'tier_status': Decimal('1'), 'target_merchant': '2, 2, 0'}, {'price_value': 311, 'type_of_product': 'electronics', 'preferred_merchant': Decimal('1'), 'reward_id': Decimal('1'), 'tier_status': Decimal('1'), 'target_merchant': '0, 1, 2'}, {'price_value': 54, 'type_of_product': 'sports', 'preferred_merchant': Decimal('1'), 'reward_id': Decimal('1'), 'tier_status': Decimal('1'), 'target_merchant': '2, 2, 1'}, {'price_value': 219, 'type_of_product': 'electronics', 'preferred_merchant': Decimal('1'), 'reward_id': Decimal('1'), 'tier_status': Decimal('1'), 'target_merchant': '0, 2, 2'}, {'price_value': 393, 'type_of_product': 'electronics', 'preferred_merchant': Decimal('1'), 'reward_id': Decimal('1'), 'tier_status': Decimal('1'), 'target_merchant': '2, 2, 1'}, {'price_value': 367, 'type_of_product': 'food', 'preferred_merchant': Decimal('1'), 'reward_id': Decimal('1'), 'tier_status': Decimal('1'), 'target_merchant': '1, 0, 1'}, {'price_value': 309, 'type_of_product': 'food', 'preferred_merchant': Decimal('1'), 'reward_id': Decimal('1'), 'tier_status': Decimal('1'), 'target_merchant': '1, 2, 2'}, {'price_value': 352, 'type_of_product': 'sports', 'preferred_merchant': Decimal('1'), 'reward_id': Decimal('1'), 'tier_status': Decimal('1'), 'target_merchant': '0, 0, 0'}]
generate_csv(data)

def send_to_s3():
    sess = sagemaker.Session()
    region = sess.boto_region_name
    s3_client = boto3.client(
        's3',
        region_name = 'ap-southeast-1'
        )

    write_bucket = sess.default_bucket()
    write_prefix = 'rewards'


    
# send_to_s3()